<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 6.13.1 (455785)"/><meta name="keywords" content="Carthage"/><meta name="author" content="moonbeammm丶"/><meta name="created" content="2017-08-22 08:45:41 +0000"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2017-09-22 03:08:14 +0000"/><title>1-5-Carthage优化技巧</title></head><body><div><span style="font-size: 26px;">一.cartfile优化技巧</span></div><div>比如我本期开发BBPhone.所以要拉取BBPhone的源码.</div><div>但是BBPhone依赖了BiliCore和BiliUtils两个库的源码.所以也要拉取BiliCore和BiliUtils的源码.</div><div>但是我们并不需要BiliCore和BiliUtils为指定分支的代码.</div><div>所以可以在cartfile里同时拉取BiliCore的源码.也同时拉取BiliCore的二进制.</div><div>并且carthage update的时候添加</div><div>这样carthage只会在第一次</div><div><img src="1-5-Carthage%E4%BC%98%E5%8C%96%E6%8A%80%E5%B7%A7.resources/6e1265f6-ea4a-4da3-858a-f0862636f184.png" height="320" width="467"/><br/></div><div><img src="1-5-Carthage%E4%BC%98%E5%8C%96%E6%8A%80%E5%B7%A7.resources/F99D3E9A-938B-45C8-8A48-893EADEE9509.png" height="506" width="458"/><br/></div><div><br/></div><div><br/></div><div><br/></div><div><span style="font-size: 28px;">二.缓存优化</span></div><div><span style="font-size: 15px;">写死carthage寻找缓存的路径.</span></div><div><img src="1-5-Carthage%E4%BC%98%E5%8C%96%E6%8A%80%E5%B7%A7.resources/3B90B6E8-DF79-4098-BFCE-C86B7A7C4E8C.png" height="52" width="369"/><br/></div><div><img src="1-5-Carthage%E4%BC%98%E5%8C%96%E6%8A%80%E5%B7%A7.resources/29094BCF-E5CC-4F45-8189-07195A570D25.png" height="149" width="761"/><br/></div><div>carthage存放缓存路径</div><div>~/资源库/Caches/org.carthage.CarthageKit/</div><div><br/></div><div><img src="1-5-Carthage%E4%BC%98%E5%8C%96%E6%8A%80%E5%B7%A7.resources/AA5C4B88-BA42-4407-BBB8-8F8E8CC3CCA2.png" height="114" width="612"/><br/></div><div><br/></div><div><br/></div><div><span style="font-size: 28px;">测试:</span></div><div><br/></div><div><span style="font-size: 23px;">测试一:缓存文件夹名字与commit号</span></div><div><br/></div><div>cartfile依赖BiliCore的develop分支</div><div><img src="1-5-Carthage%E4%BC%98%E5%8C%96%E6%8A%80%E5%B7%A7.resources/EB64D8C4-FD96-4600-8D60-95015AC403DD.png" height="44" width="410"/><br/></div><div>运行update.进入carthage缓存路径下.</div><div><img src="1-5-Carthage%E4%BC%98%E5%8C%96%E6%8A%80%E5%B7%A7.resources/F6656172-0CF2-4D91-80B4-B6B287EFD202.png" height="110" width="884"/><br/></div><div>查看BiliCore.develop 的commit号</div><div><img src="1-5-Carthage%E4%BC%98%E5%8C%96%E6%8A%80%E5%B7%A7.resources/85E7B72B-FEAE-46BD-A314-898C6442EFC8.png" height="48" width="207"/><br/></div><div><img src="1-5-Carthage%E4%BC%98%E5%8C%96%E6%8A%80%E5%B7%A7.resources/1BD1308A-610D-453A-9EF9-7A588DDA9ED3.png" height="67" width="352"/><br/></div><div><br/></div><div><span style="font-size: 20px;">结论:</span></div><div>carthage缓存路径为:</div><div><span style="color: rgb(4, 51, 255);">DerivedData</span><span style="color: rgb(255, 147, 0);">/库名/</span><span style="color: rgb(148, 33, 146);">tag号(或者分支的commit)</span></div><div><br/></div><div><br/></div><div><span style="font-size: 24px;">测试二:修改derivedData 路径.</span></div><div><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">carthage update --platform iOS --derived-data ~/Desktop/sgx/sgx</span></div><div><img src="1-5-Carthage%E4%BC%98%E5%8C%96%E6%8A%80%E5%B7%A7.resources/417F3A5C-B264-4797-A3CF-B26231E39298.png" height="81" width="1003"/><br/></div><div><span style="font-size: 21px;">结论:</span></div><div>发现只是修改了derived-data文件夹的路径.</div><div>derived-data里面的路径还是carthage自己设置的.</div><div><br/></div><div><br/></div><div><span style="font-size: 32px;">三.update命令技巧</span></div><div>1.一开始.resolved文件里对BiliUtils依赖是1.0.0的tag</div><div><img src="1-5-Carthage%E4%BC%98%E5%8C%96%E6%8A%80%E5%B7%A7.resources/D61C6E86-8743-4FB5-8F3F-6371D41A8DF1.png" height="71" width="412"/><br/></div><div>2.修改cartfile对BiliUtils依赖为develop</div><div>3.运行命令</div><div><img src="1-5-Carthage%E4%BC%98%E5%8C%96%E6%8A%80%E5%B7%A7.resources/B50AD00A-388B-4D5A-9D55-D4655024E9C9.png" height="46" width="385"/><br/></div><div>4.查看.resolved文件.发现更新了.但是没用去build.</div><div><img src="1-5-Carthage%E4%BC%98%E5%8C%96%E6%8A%80%E5%B7%A7.resources/7A0A1EB2-8872-48F8-8CC3-514BFC148DC6.png" height="87" width="659"/><br/></div><div><br/></div><div><span style="font-size: 21px;">总结:</span></div><div>如果加了—no-build —no-checkout.运行update命令.</div><div>那carthage就只更新cartfile.resolved文件.</div><div>不会去更新Carthage/Checkouts/ 文件夹下工程的分支</div><div>也不会去build新的framework</div><div><br/></div><div>如果只加了—no-build.运行update命令</div><div>那么carthage会更新cartfile.resolved文件.</div><div>并且更新Carthage/Checkouts/ 文件夹下工程的代码</div><div>也不会去build的新的framework</div><div><br/></div><div><br/></div><div><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">carthage update</span></div><div>1.解析更新.resolved文件 (fetching)</div><div>2.check out最新代码</div><div>3.build framework</div><div><br/></div><div><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">carthage bootstrap</span></div><div>1.check out最新代码</div><div>2.build framework</div><div><br/></div><div>参数</div><div><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">--no-build </span></div><div>不去build framework</div><div><br/></div><div><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">--no-checkout</span></div><div>不去check out 最新代码</div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></body></html>