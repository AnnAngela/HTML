<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 6.13.1 (455785)"/><meta name="keywords" content="Carthage"/><meta name="altitude" content="12.25646781921387"/><meta name="author" content="moonbeammm丶"/><meta name="created" content="2017-08-24 17:26:13 +0000"/><meta name="latitude" content="31.28981652880264"/><meta name="longitude" content="121.4717048080707"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2017-09-25 03:20:58 +0000"/><title>1-4-Carthage总包阶段打framework</title></head><body><div><span style="font-size: 26px;">一.Log日志</span></div><div><span style="color: rgb(255, 38, 0);">1.0.0</span> &gt;&gt;&gt;&gt;&gt;&gt;2017.8.25</div><div>初始版本</div><div><span style="color: rgb(255, 38, 0);">2.0.0</span> &gt;&gt;&gt;&gt;&gt;&gt;2017.9.8</div><div>修复打tag的时机错误问题.应该在出framwork包之前就要打好tag</div><div><font color="#ff2600">2.0.1</font>&gt;&gt;&gt;&gt;&gt;&gt;&gt;2017.9.25</div><div>添加bug记录一</div><div><br/></div><div><br/></div><div><span style="font-size: 27px;">二.操作流程</span></div><div><br/></div><div>在总包阶段.每个业务组都需要打一个各自业务库的release版framework包</div><div><span style="font-size: 17px;">流程如下.以BBUper为例</span></div><div><br/></div><div><span style="font-size: 26px;">1.checkout对应分支</span></div><div>将BBUper库切到你这次的最终总包分支.如release/r5.13_bbuper</div><div><br/></div><div><span style="font-size: 31px;">2.打tag</span></div><div>2.1.打开BBUper工程.修改Build settings-&gt;curent project version  你的tag号.</div><div><img src="1-4-Carthage%E6%80%BB%E5%8C%85%E9%98%B6%E6%AE%B5%E6%89%93framework.resources/7A5A32F8-2FEE-40FA-A3D6-371E7B7E4873.png" height="151" width="721"/><br/></div><div>2.2.给你这个release/r5.13-bbuper打tag</div><div><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">git tag 1.0.4</span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    // 给当前分支打上tag号</span></div><div><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">git push origin —tags</span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    // 将tag号push到远端</span></div><div><br/></div><div><span style="font-size: 25px;">3.给BBUper创建干净环境</span></div><div>将BBUper文件夹复制到一个干净的目录下(如桌面)</div><div><span style="font-size: 17px;">在干净的目录下打开BBUper.xcodeproj</span></div><div><img src="1-4-Carthage%E6%80%BB%E5%8C%85%E9%98%B6%E6%AE%B5%E6%89%93framework.resources/547CBEE6-E0A5-4689-857D-3F70B88138F8.png" height="82" width="509"/><br/></div><div><br/></div><div><span style="font-size: 29px;">4.在干净目录下编译成功BBUper</span></div><div>打开后直接command+b.</div><div>有错就修.没错就跳过这一步.</div><div><br/></div><div><span style="font-size: 29px;">5.在系统根目录创建opt/iOS/</span></div><div><span style="font-size: 16px;">创建文件夹并添加读写权限</span></div><div><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">cd /</span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">      // 进入系统根目录</span></div><div><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">sudo mkdir opt</span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    // 在系统根目录下创建opt文件夹</span></div><div><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">(输入密码)</span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">     // 系统要求你输入电脑密码</span></div><div><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">cd opt </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">       // 进入opt文件夹</span></div><div><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">sudo mkdir iOS</span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    // 在opt文件夹下创建iOS文件夹</span></div><div><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">sudo chown `whoami` /opt/iOS </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);"> // 将/opt/iOS文件夹所有者改为你自己  (`whoami`是一个命令.即你电脑的名字.)</span></div><div><br/></div><div><span style="font-size: 27px;">6.转移目录</span></div><div><span style="font-size: 17px;">将刚才编译通过的BBUper复制到/opt/iOS目录下</span></div><div><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">cd ~/Desktop/ </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    // 进入BBUper当前目录下</span></div><div><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">mv BBUper /opt/iOS </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    // 将BBUper移动到/opt/iOS文件夹下</span></div><div><br/></div><div><span style="font-size: 26px;">7.build &amp;&amp; archive</span></div><div><span style="font-size: 16px;">在/opt/iOS/BBUper目录下执行build &amp;&amp; archive命令获取zip包</span></div><div><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">cd /opt/iOS/BBUper</span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #00f900; background-color: rgba(30, 30, 30, 0.87);">/</span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #00f900; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #00f900; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #00f900; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #00f900; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #00f900; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #00f900; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #00f900; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #00f900; background-color: rgba(30, 30, 30, 0.87);">      // 进入BBUper目录</span></div><div><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">carthage build --platform iOS --no-skip-current</span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">  // 编译BBUper工程生成framework</span></div><div><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">carthage archive BBUper</span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">    </span><span style="font: 12.0px 'Andale Mono'; font-variant-ligatures: no-common-ligatures; color: #28fe14; background-color: rgba(30, 30, 30, 0.87);">      // 将BBUper.framework压缩成zip包</span></div><div>这个就是我们要的zip包</div><div><img src="1-4-Carthage%E6%80%BB%E5%8C%85%E9%98%B6%E6%AE%B5%E6%89%93framework.resources/0AE8FB31-4305-4F64-84EE-9A085AB72EF9.png" height="121" width="255"/><br/></div><div><br/></div><div><span style="font-size: 27px;">8.news &amp;&amp; dependencies</span></div><div><span style="font-size: 17px;">修改news.md和dependencies.md并push到你这个release分支.</span></div><div>8.1news.md主要写你这次做了什么修改.如下</div><div><img src="1-4-Carthage%E6%80%BB%E5%8C%85%E9%98%B6%E6%AE%B5%E6%89%93framework.resources/37B6DCD6-04A9-47CB-8828-40D7EDF5F30B.png" height="456" width="372"/><br/></div><div>8.2dependencies.md主要写你的库依赖了哪些库.和依赖的库的tag号.如下.</div><div><img src="1-4-Carthage%E6%80%BB%E5%8C%85%E9%98%B6%E6%AE%B5%E6%89%93framework.resources/63A08513-F2F5-490E-87AA-188AD80AE651.png" height="66" width="151"/><br/></div><div><br/></div><div><span style="font-size: 29px;">9.写邮件.将tag号和zip</span></div><div><br/></div><div>邮件主要填写</div><div>1.此次发版的tag号.</div><div>2.步骤6生成的zip包.</div><div>3.你此次做的更改(即news.md里填写的)</div><div><br/></div><hr/><div><br/></div><div><span style="font-size: 28px;">三.BUG记录</span></div><div><br/></div><div><span style="font-size: 22px;">1.编译失败</span></div><div>1.如果你这个工程还没创建cartfile.那就先创建cartfile.填写你依赖的库.然后运行carthage update命令</div><div>2.然后把carthage/Build/iOS下你依赖的库拖到工程里.</div><div>3.如果是对源码依赖.就把carthage/Checkouts/下的.xcodeproj拖到你的工程.并做link</div><div>4.再command+B编译.在继续根据error信息调试修改.</div><div><br/></div><div><span style="font-size: 22px;">2.编译产物tag号错误</span></div><div>在opt/iOS/BBPhone 目录下build出来BBPhone.framework的tag号错误.</div><div>1.检查该目录下BBPhone工程的build setting &gt;&gt; current version是否正确.</div><div>2.检查该目录下的BBPhone工程的分支是否正确.</div><div>如果上述两步都没问题.那就把该目录下的BBPhone工程删除.</div><div>通过gitlab上BBPhone的url直接拉取.</div><div>然后checkout到相应分支.</div><div>再build &amp;&amp; archive.</div><div><br/></div></body></html>